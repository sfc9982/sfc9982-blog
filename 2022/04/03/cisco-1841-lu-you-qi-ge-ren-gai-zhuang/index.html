<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Cisco 1841 路由器个人用途自定义配置, sfc9982">
    <meta name="description" content="Cisco 1841
路由器个人用自定义配置
路由器基础配置
权限
Cisco路由器的设计颇具编程和工业美感。权限管理类似Linux,需要enable (en)进入特权模式。使用后exit退出。终端前的&amp;gt; / #会提示当前权限状态
命">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="google-site-verification" content="VHbds6A71Ln4-2rYPTAdF_Fvy2j0UDrLSa8d4CNXNT0" />
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-CVFRQD6QTZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CVFRQD6QTZ');
</script>


    <title>Cisco 1841 路由器个人用途自定义配置 | sfc9982&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.avif">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="sfc9982's blog" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.avif" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">sfc9982&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.avif" class="logo-img circle responsive-img">
        
        <div class="logo-name">sfc9982&#39;s blog</div>
        <div class="logo-desc">
            
            sfc9982 Personal Study Blog of Sci &amp; Tech
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages_anime/astero-20190127a.avif')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Cisco 1841 路由器个人用途自定义配置</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Cisco/">
                                <span class="chip bg-color">Cisco</span>
                            </a>
                        
                            <a href="/tags/%E7%BD%91%E7%BB%9C/">
                                <span class="chip bg-color">网络</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B/" class="post-category">
                                网络工程
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-04-03
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-07-19
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    13 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="cisco-1841-路由器个人用自定义配置">Cisco 1841
路由器个人用自定义配置</h1>
<h2 id="路由器基础配置">路由器基础配置</h2>
<h3 id="权限">权限</h3>
<p><strong>Cisco</strong>路由器的设计颇具编程和工业美感。权限管理类似Linux,需要<code>enable (en)</code>进入特权模式。使用后<code>exit</code>退出。终端前的<code>&gt; / #</code>会提示当前权限状态</p>
<h3 id="命令">命令</h3>
<p>在无冲突命令的情况下，命令可以被简写。</p>
<p>如<code>interface -&gt; int</code>,
<code>configure -&gt; con</code></p>
<h3 id="快捷键">快捷键</h3>
<p><code>Ctrl + A</code>：移动光标至行头</p>
<p><code>Ctr l+ E</code>：移动光标至行尾</p>
<p><code>Ctrl + U</code>：刪除一行(要先使用Ctrl+E)</p>
<p><code>Ctrl + Shift + 6</code>：Cisco命令行独有 中断Cisco IOS
Process，如：Ping指令</p>
<p><code>Ctrl + C</code>：中断当前行Command</p>
<p><code>Ctrl + Z</code>：结束Configure Mode，回到Privilege Mode</p>
<p>常用命令：</p>
<pre class="line-numbers language-none"><code class="language-none"># show history

# terminal history size 50 !历史记录条数

# terminal length 100      !每一行最多字符个数，多余的以 ...$形式省略

# show running-config | include hostname (只打印包含hostname的配置)

&nbsp;&nbsp; =&gt; 可以用 begin, exclude, include, secion<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="安装向导">安装向导</h3>
<p>终端内执行<code>setup</code>开启安装向导。注意<code>secret</code>是Hash存储密码，level
5为MD5加密，level
7为思科自有算法加密，<code>password</code>为明文存储，且二者不能被同时设置。</p>
<p>使用 <code>service password-encryption</code> 开启密码加密</p>
<h3 id="设置保存">设置保存</h3>
<p>每次重启路由器时，路由器都会丢弃当前设置，从内存(NVRAM)中重新读取设置。</p>
<p>这就需要我们及时存储当前设置。</p>
<pre class="line-numbers language-none"><code class="language-none">write memory
copy running-config startup-config<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>这两条命令是等效的，会把设置保存到内存中</p>
<p>备份设置也很简单：</p>
<pre class="line-numbers language-none"><code class="language-none">copy startup-config flash:[备份文件]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>会将设置备份到CompactFlash卡中</p>
<h3 id="远程管理访问">远程管理访问</h3>
<p>管理 Cisco Router 有多种方式：console, tty, vty, aux...</p>
<p>出于安全原因，除了console的远程访问，都是被默认关闭的。</p>
<h4 id="ssh">SSH</h4>
<h5 id="验证设备是否支持ssh">验证设备是否支持SSH</h5>
<p><code>show ip ssh</code></p>
<h5 id="生成-rsa-密钥对">生成 RSA 密钥对</h5>
<p><code>crypto key generate rsa</code>
生成新的密钥，如果选择了2048-bit长度的，为了安全，生成时长可能高达10分钟左右。<br>
<code>crypto key zeroize rsa</code>
清除先前生成的密钥，同时也会关闭SSH</p>
<h5 id="登录用户">登录用户</h5>
<pre class="line-numbers language-none"><code class="language-none">Router(config)#username &lt;用户名&gt; privilege &lt;0-15&gt; password &lt;密码&gt; ! 新建一个用户

Router(config)#ip ssh time-out 120             !修改超时时间
Router(config)#ip ssh authentication-retries 1 !修改重认证次数。
Router(config)#ip ssh version 2                !修改SSH版本

Router(config)#ip domain-name man.com    !配置域名为man.com
Router(config)#crypto key generate rsa   !生成加密密钥
Router(config)#username man secret cisco !在本地创建一个用户名为man并且加密密码为cisco的用户。
Router(config-line)#transport input ssh  !启用SSH登陆
Router(config-line)#login local          !采用本地验证
Router(config-line)#privilege level 15   !默认为enable模式<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果想要SSH登录后默认就是 <strong>enable</strong> 模式的话：</p>
<pre class="line-numbers language-none"><code class="language-none">username&nbsp;&lt;username&gt; privilege 15 secret&nbsp;&lt;passowrd&gt;
aaa new-model
aaa authentication login default group tacacs+ local&nbsp;
aaa authorization exec default group tacacs+ local

aaa authorization exec LOCAL auto-enable<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="终端ssh登录报错">终端ssh登录报错</h5>
<p>Cisco使用的ssh算法比较老旧，需要设置ssh参数支持。</p>
<p>位于： - 全局：/etc/ssh_config - 用户：~/.ssh/config</p>
<pre class="line-numbers language-none"><code class="language-none">#Ciphers aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc,arcfour
#KexAlgorithms ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1
#MACs hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-ripemd160,hmac-sha1-96,hmac-md5-96,hmac-sha2-256,hmac-sha2-256-96,hmac-sha2-512,hmac-sha2-512-96<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>选择合适的设置取消注释即可。</p>
<p><a target="_blank" rel="noopener" href="https://community.cisco.com/t5/security-documents/guide-to-better-ssh-security/ta-p/3133344">Reference</a></p>
<h4 id="httphttps-登入管理">HTTP/HTTPS 登入管理</h4>
<pre class="line-numbers language-none"><code class="language-none">R1(config)#ip http server ## 启动 http server，默认端口为TCP 80

R1(config)#ip http port 8080 ## 可以更改端口

R1(config)#ip http authentication local ## default 使用 enable 密碼 ， 這裡改為本地認證<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可选参数：</p>
<pre class="line-numbers language-none"><code class="language-none">R1(config)#ip http max-connections 5

R1(config)#ip http access-class 20 ## 可以设置 ACL 来仅放行特定 source ip

如果要使用HTTPS：

R1(config)#ip http secure-server ## 其他同http server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看:</p>
<pre class="line-numbers language-none"><code class="language-none">R1#sh ip http server all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="telnet">TELNET</h3>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/ios-software-releases-110/45843-configpasswords.html">Cisco
Support</a></p>
</blockquote>
<h3 id="ntp时间同步设置">NTP时间同步设置</h3>
<pre class="line-numbers language-none"><code class="language-none">ntp update-calendar
ntp server 202.118.1.81<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>默认会获取格林尼治时间，需要切换到 <strong>UTC+8</strong>：</p>
<p><code>clock timezone CST +8</code></p>
<p>更新硬件时间：</p>
<p><code>clock update-calendar</code></p>
<h2 id="网络基础配置">网络基础配置</h2>
<h3 id="配置内网接口">配置内网接口</h3>
<pre class="line-numbers language-none"><code class="language-none">interface FastEthernet0/0

description Uplink to Home Router

ip address dhcp

ip nat outside<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="配置外网接口">配置外网接口</h3>
<pre class="line-numbers language-none"><code class="language-none">interface FastEthernet0/1

description Local LAN

ip address 192.168.1.1 255.255.255.0

ip nat inside<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="开启重载端口映射nat">开启重载端口映射(NAT)</h3>
<pre class="line-numbers language-none"><code class="language-none">ip nat inside source list 1 interface FastEthernet0/0 overload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="出接口">出接口</h3>
<p>（可以使用下一跳代替）
我在使用无限AP的环境中将下一跳设置为主路由，<code>tracert</code>就不会提示经过无线AP的IP了。
</p><pre class="line-numbers language-none"><code class="language-none">ip route 0.0.0.0 0.0.0.0 FastEthernet0/0 dhcp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p></p>
<h3 id="访问列表开放权限">访问列表开放权限</h3>
<pre class="line-numbers language-none"><code class="language-none">access-list 1 permit 10.0.0.0 0.255.255.255<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="dns服务器">DNS服务器</h3>
<p>在路由器上启动DNS服务。</p>
<pre class="line-numbers language-none"><code class="language-none">R1#conf t
R1(config)# ip dns server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>我们需要在路由器上配置公共的域名服务器，该设置可以使得路由器进行“递归式”的DNS查询。换而言之，当路由器所接收到的每个工作站的请求时，路由器都会通过询问多个DNS服务器，最终将结果反馈给发送请求的工作站。</p>
<pre class="line-numbers language-none"><code class="language-none">R1(config)#ip name-server 1.1.1.1
R1(config)#ip name-server 1.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>思科的路由器IOS允许你最多设置6个不同的DNS服务器。通常情况下，你会设置成本地服务提供商的DNS服务器地址，以此保证快速的响应；随后配置一些免费的公共DNS服务器地址，这样配置保证了你可以通过本地ISP或公共DNS服务器来获得响应。</p>
<p>第三步，配置DNS服务器对本地用户名和IP地址进行映射。设置完成后，当Alan的PC试图ping或连接Wayne的PC，路由器将成功解析他的netbios名称到适当的ip地址。配置如下：</p>
<pre class="line-numbers language-none"><code class="language-none">R1(config)#ip host alice 192.168.1.10
R1(config)#ip host bob 192.168.1.11<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>设置工作站时，你可以把路由器的IP地址设置为主DNS服务器的地址。</p>
<h3 id="dhcp-服务器配置">DHCP 服务器配置</h3>
<p>DHCP服务的配置</p>
<pre class="line-numbers language-none"><code class="language-none">dhcp#configure terminal&nbsp;&nbsp;&nbsp; //进入全局模式

dhcp(config)#service dhcp&nbsp;&nbsp;&nbsp;&nbsp; //打开dhcp功能

dhcp(config)#no ip dhcp conflictlogging&nbsp;&nbsp; //关闭dhcp日志记录

dhcp(config)#ip dhcp pool cisco&nbsp;&nbsp;&nbsp;&nbsp; //配置dhcp服务器的名称为cisco

dhcp(dhcp-config)#network 192.168.1.0 255.255.255.0&nbsp;&nbsp;&nbsp;&nbsp; //配置dhcp服务器要分配的网段

dhcp(dhcp-config)#default-router 192.168.1.1&nbsp;&nbsp;&nbsp; //配置默认网关为192.168.1.1

dhcp(dhcp-config)#dns-server 192.168.1.1&nbsp;&nbsp;&nbsp; //配置dns服务器为192.168.1.1

dhcp(dhcp-config)#lease 3 //地址租用期限: 3天

dhcp(dhcp-config)#exit&nbsp;&nbsp;&nbsp; //退出dhcp配置模式

dhcp(config)#ip&nbsp; dhcp&nbsp; excluded-address 192.168.1.200 192.168.1.254&nbsp; //配置dhcp不分配的地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>客户端获取IP地址</p>
<pre class="line-numbers language-none"><code class="language-none">Client#configure terminal&nbsp; &nbsp;//进入全局模式

dhcp(config)#interface FastEthernet0/0&nbsp; &nbsp;&nbsp;//进入fastethernet0/0接口

dhcp(config-if)#ip address dhcp&nbsp; &nbsp;&nbsp;//从dhcp服务器获取IP地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="dhcp分配静态ip">DHCP分配静态IP</h3>
<pre class="line-numbers language-none"><code class="language-none">ip dhcp pool vlan31
network 172.31.255.0 255.255.255.0
default-router 172.31.255.254
dns-server 202.96.209.133 8.8.8.8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>先将特殊IP地址从dhcp中剔除掉，以免后面造成ip地址冲突</p>
<pre class="line-numbers language-none"><code class="language-none">ip dhcp excluded-address 172.31.255.1
ip dhcp excluded-address 172.31.255.100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>编写一个静态IP地址的pool</p>
<pre class="line-numbers language-none"><code class="language-none">ip dhcp pool static_vlan31_1
host 172.31.255.100 255.255.255.0
client-identifier 015c.f9dd.48c0.da //mac前面要补“01”
dns-server 202.96.209.133 8.8.8.8
default-router 172.31.255.254
lease infinite //永久<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果要立即生效，需要清空自动分配ip的缓存</p>
<pre class="line-numbers language-none"><code class="language-none">dmz_cisco3750#clear ip dhcp binding *
dmz_cisco3750#show ip dhcp binding
IP address Client-ID/ Lease expiration Type
Hardware address
172.31.255.100 015c.f9dd.48c0.da Infinite Manual
dmz_cisco3750#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>为了避免其他用户私自修改保留的静态IP地址，需要再增加arp绑定信息</p>
<pre class="line-numbers language-none"><code class="language-none">arp 172.31.255.100 5cf9.dd48.c0da arpa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>具体命令如下:</p>
<pre class="line-numbers language-none"><code class="language-none">dmz_cisco3750(config)#do show arp
Protocol Address Age (min) Hardware Addr Type Interface
Internet 172.31.255.100 0 5cf9.dd48.c0da ARPA Vlan31
dmz_cisco3750(config)#arp 172.31.255.100 5cf9.dd48.c0da arpa
dmz_cisco3750(config)#do show arp
Protocol Address Age (min) Hardware Addr Type Interface
Internet 172.31.255.100 - 5cf9.dd48.c0da ARPA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="解决dhcp客户端机器获取ip慢的问题">解决DHCP客户端机器获取IP慢的问题</h3>
<p>在常见的DHCP部署中，很容易遇到的问题就是，当客户端接入进去，获取地址很慢，或者是获取不到地址，但是DHCP是没问题的，很常见的问题就是生成树导致的，PC接入的时候，生成树要计算，花费30s的时间，所以容易造成获取地址不到的情况，可以配置STP的快速端口，来解决该问题，跳过生成树的检查。</p>
<h4 id="在路由器上">在路由器上：</h4>
<pre class="line-numbers language-none"><code class="language-none">Cisco-1841(config)#interface f0/1
Cisco-1841(config-if)#spanning-tree portfast bpduguard<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="在交换机上">在交换机上：</h4>
<pre class="line-numbers language-none"><code class="language-none">Cisco-2960(config)#interface range f0/2-5
Cisco-2960(config-if-range)#spanning-tree portfast<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="nat-端口映射">NAT 端口映射</h3>
<p>静态NAT： </p><pre class="line-numbers language-none"><code class="language-none">1. 指定NAT内部接口
    在内网相应接口的接口配置模式下执行：
    ip nat inside
2. 指定NAT外部接口
    在外网相应接口的接口配置模式下执行：
    ip nat outside
3. 在内部本地地址与内部全局地址之间建立静态地址转换关系：
    ip nat inside source static 内部本地地址 内部全局地址
4. 在外部全局地址与外部本地地址之间建立静态地址转换关系：
    ip nat outside source static 外部全局地址 外部本地地址
5. 
    show ip nat translations：显示当前存在的NAT转换信息。 
    show ip nat statics：查看NAT的统计信息。 
    show ip nat translations verbose：显示当前存在的NAT转换的详细信息。 
    debug ip nat：跟踪NAT操作，显示出每个被转换的数据包。 
    clear ip nat translations *:删除NAT映射表中的所有内容.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p>
<p>动态地址NAT：</p>
<p></p><pre class="line-numbers language-none"><code class="language-none">1. 指定NAT内部接口
    在内网相应接口的接口配置模式下执行：
    ip nat inside
2. 指定NAT外部接口
    在外网相应接口的接口配置模式下执行：
    ip nat outside
3. 在全局配置模式下，定义一个标准的access-list规则，声明允许哪些内部本地地址可以进行动态地址转换：
    access-list list-number permit 源地址 通配符
        其中，list-number为1－99之间的一个任意整数。
4. 在全局配置模式下，定义内部全局地址池：
    ip nat pool 地址池名  起始IP地址  终止IP地址  netmask  子网掩码
        其中，地址池名可以任意设定，但最好有一定的说明意义。
5. 在全局配置模式下，定义符合先前定义的access-list规则的IP数据包与先前定义的地址池中的IP地址进行转换：
    ip nat inside source list list-number pool 内部全局地址池名
6. 
    no ip nat pool name			删除全局地址池
    no access-list access-list-number		删除访问列表
    no ip nat inside source			删除动态源地址转换<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p>
<p>网络地址端口转换NAPT(PAT)：</p>
<p></p><pre class="line-numbers language-none"><code class="language-none">1.指定NAT内部接口
    在内网相应接口的接口配置模式下执行：ip nat inside
2. 指定NAT外部接口
    在外网相应接口的接口配置模式下执行：
    ip nat outside
3. 在全局配置模式下，定义内部全局地址池：
    ip nat pool  地址池名  起始IP地址  终止IP地址  netmask  子网掩码
        其中，地址池名可以任意设定，但最好有一定的说明意义。
4. 在全局配置模式下，定义一个标准的access-list规则，声明允许哪些内部本地地址可以进行复用地址转换：
    access-list list-number permit 源地址 通配符
        其中，list-number为1－99之间的一个任意整数。
5. 在全局配置模式下，定义符合先前定义的access-list规则的IP数据包与先前定义的地址池中的IP地址进行复用地址转换：
    ip nat inside source list list-number pool 内部全局地址池名 overload<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> ### 更改MAC地址<p></p>
<pre class="line-numbers language-none"><code class="language-none">Cisco-1841(config-if)#mac-address ?
  H.H.H  MAC address<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/469132">Learn
More</a><br>
<a target="_blank" rel="noopener" href="https://blog.51cto.com/sunjie123/1673697">Learn More</a> <a target="_blank" rel="noopener" href="https://community.cisco.com/t5/routing/login-to-directly-into-quot-privilege-mode-quot/td-p/2131983">And
More</a></p>
</blockquote>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://googles.plus" rel="external nofollow noreferrer">sfc9982</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                    </span>
                <span class="reprint-info">
                    <a href="https://googles.plus/2022/04/03/cisco-1841-lu-you-qi-ge-ren-gai-zhuang/">https://googles.plus/2022/04/03/cisco-1841-lu-you-qi-ge-ren-gai-zhuang/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-ND 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://googles.plus" target="_blank">sfc9982</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Cisco/">
                                    <span class="chip bg-color">Cisco</span>
                                </a>
                            
                                <a href="/tags/%E7%BD%91%E7%BB%9C/">
                                    <span class="chip bg-color">网络</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/04/06/warshall-suan-fa-qiu-chuan-di-bi-bao/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages_anime/2.avif" class="responsive-img" alt="Warshall算法求传递闭包">
                        
                        <span class="card-title">Warshall算法求传递闭包</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-04-06
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%95%B0%E5%AD%A6/" class="post-category">
                                    数学
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/">
                        <span class="chip bg-color">离散数学</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/04/01/si-ke-fu-hua-xiang-mu-day4/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages_anime/947433860.avif" class="responsive-img" alt="思科人才孵化项目 Day4">
                        
                        <span class="card-title">思科人才孵化项目 Day4</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-04-01
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%80%9D%E7%A7%91%E4%BA%BA%E6%89%8D%E5%AD%B5%E5%8C%96%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" class="post-category">
                                    思科人才孵化项目笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Cisco/">
                        <span class="chip bg-color">Cisco</span>
                    </a>
                    
                    <a href="/tags/%E6%80%9D%E7%A7%91/">
                        <span class="chip bg-color">思科</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="song"
                   id="5213502"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='one'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank">
                本网站由
                <img border="0" height="26" src="/images/upyun.png" align="center">
                提供CDN加速/云存储服务
            </a>
            <br>
            
            <a href="https://www.cloudflare.com/" target="_blank">
                CDN Services for countries and regions out of Mainland China are powered by
                <img border="0" height="18" src="/images/CF_logo_horizontal_whitetype.svg" align="top">
            </a>
            <br>
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2023</span>
            
            <a href="/about" target="_blank">sfc9982</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">200.3k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "11";
                        var startDate = "7";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/sfc9982/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:admin@googles.plus" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2120935182" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2120935182" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


<!--
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
    <script type="text/javascript" src="/js/fireworks.js"></script>
-->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>

<!--     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
    <script src="/live2d-widget/autoload.js"></script>
 -->
    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/mikoto.model.json"},"display":{"position":"left","width":250,"height":500},"mobile":{"show":false},"log":false});</script>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 2,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body>

</html>
